{
  "Repository": "corefx",
  "Definitions": {
    "Path": ".",
    "Type": "VSTS",
    "BaseUrl":  "https://devdiv.visualstudio.com/DefaultCollection"
  },
  "Pipelines": [
    {
      "Name": "Trusted-All-Release",
      "Parameters": {
        "TreatWarningsAsErrors": "false"
      },
      "BuildParameters": {
        "PB_ConfigurationGroup": "Release"
      },
      "Definitions": [
        {
          "Name": "DotNet-CoreFx-Trusted-Linux",
          "Parameters": {
            "PB_DockerTag": "ubuntu1404_prereqs_v3",
            "PB_AdditionalArguments": "-portableLinux"
          },
          "ReportingParameters": {
            "OperatingSystem": "Ubuntu 14.04",
            "Type": "build/product/",
            "ConfigurationGroup": "Release"
          }
        },
        {
          "Name": "DotNet-CoreFx-Trusted-Linux",
          "Parameters": {
            "PB_DockerTag": "debian82_prereqs_2"
          },
          "ReportingParameters": {
            "OperatingSystem": "Debian 8.2",
            "Type": "build/product/",
            "ConfigurationGroup": "Release"
          }
        },
        {
          "Name": "DotNet-CoreFx-Trusted-Linux",
          "Parameters": {
            "PB_DockerTag": "fedora23_prereqs"
          },
          "ReportingParameters": {
            "OperatingSystem": "Fedora 2.3",
            "Type": "build/product/",
            "ConfigurationGroup": "Release"
          }
        },
        {
          "Name": "DotNet-CoreFx-Trusted-Linux",
          "Parameters": {
            "PB_DockerTag": "fedora24_prereqs_v4"
          },
          "ReportingParameters": {
            "OperatingSystem": "Fedora 24",
            "Type": "build/product/",
            "ConfigurationGroup": "Release"
          }
        },        
        {
          "Name": "DotNet-CoreFx-Trusted-Linux",
          "Parameters": {
            "PB_DockerTag": "opensuse132_prereqs_v4"
          },
          "ReportingParameters": {
            "OperatingSystem": "openSUSE 13.2",
            "Type": "build/product/",
            "ConfigurationGroup": "Release"
          }
        },
        {
          "Name": "DotNet-CoreFx-Trusted-Linux",
          "Parameters": {
            "PB_DockerTag": "opensuse421_prereqs_v3"
          },
          "ReportingParameters": {
            "OperatingSystem": "openSUSE 42.1",
            "Type": "build/product/",
            "ConfigurationGroup": "Release"
          }
        },
        {
          "Name": "DotNet-CoreFx-Trusted-Linux",
          "Parameters": {
            "PB_DockerTag": "rhel7_prereqs_2"
          },
          "ReportingParameters": {
            "OperatingSystem": "RedHat 7",
            "Type": "build/product/",
            "ConfigurationGroup": "Release"
          }
        },
        {
          "Name": "DotNet-CoreFx-Trusted-Linux",
          "Parameters": {
            "PB_DockerTag": "ubuntu1404_prereqs_v3"
          },
          "ReportingParameters": {
            "OperatingSystem": "Ubuntu 14.04",
            "Type": "build/product/",
            "ConfigurationGroup": "Release"
          }
        },
        {
          "Name": "DotNet-CoreFx-Trusted-Linux",
          "Parameters": {
            "PB_DockerTag": "ubuntu1604_prereqs"
          },
          "ReportingParameters": {
            "OperatingSystem": "Ubuntu 16.04",
            "Type": "build/product/",
            "ConfigurationGroup": "Release"
          }
        },
        {
          "Name": "DotNet-CoreFx-Trusted-Linux",
          "Parameters": {
            "PB_DockerTag": "ubuntu1610_prereqs_v2"
          },
          "ReportingParameters": {
            "OperatingSystem": "Ubuntu 16.10",
            "Type": "build/product/",
            "ConfigurationGroup": "Release"
          }
        },
        {
          "Name": "DotNet-CoreFx-Trusted-Linux",
          "Parameters": {
            "PB_DockerTag": "alpine_prereqs"
          },
          "ReportingParameters": {
            "OperatingSystem": "Alpine 3.4.3",
            "Type": "build/product/",
            "ConfigurationGroup": "Release"
          }
        },        
        {
          "Name": "DotNet-CoreFx-Trusted-OSX",
          "ReportingParameters": {
            "OperatingSystem": "OSX",
            "Type": "build/product/",
            "ConfigurationGroup": "Release"
          }
        },
        {
          "Name": "DotNet-CoreFx-Trusted-Windows",
          "Parameters": {
            "PB_Platform": "arm"
          },
          "ReportingParameters": {
            "OperatingSystem": "Windows",
            "Type": "build/product/",
            "Platform": "arm",
            "ConfigurationGroup": "Release"
          }
        },
        {
          "Name": "DotNet-CoreFx-Trusted-Windows",
          "Parameters": {
            "PB_Platform": "arm64"
          },
          "ReportingParameters": {
            "OperatingSystem": "Windows",
            "Type": "build/product/",
            "Platform": "arm64",
            "ConfigurationGroup": "Release"
          }
        },
        {
          "Name": "DotNet-CoreFx-Trusted-Windows",
          "Parameters": {
            "PB_Platform": "x64"
          },
          "ReportingParameters": {
            "OperatingSystem": "Windows",
            "Type": "build/product/",
            "Platform": "x64",
            "ConfigurationGroup": "Release"
          }
        },
        {
          "Name": "DotNet-CoreFx-Trusted-Windows",
          "Parameters": {
            "PB_Platform": "x86"
          },
          "ReportingParameters": {
            "OperatingSystem": "Windows",
            "Type": "build/product/",
            "Platform": "x86",
            "ConfigurationGroup": "Release"
          }
        }
      ]
    },
    {
      "Name": "Trusted-All-Debug",
      "Parameters": {
        "TreatWarningsAsErrors": "false"
      },
      "BuildParameters": {
        "PB_ConfigurationGroup": "Debug"
      },
      "Definitions": [
        {
          "Name": "DotNet-CoreFx-Trusted-Linux",
          "Parameters": {
            "PB_DockerTag": "debian82_prereqs_2"
          },
          "ReportingParameters": {
            "OperatingSystem": "Debian 8.2",
            "Type": "build/product/",
            "ConfigurationGroup": "Debug"
          }
        },
        {
          "Name": "DotNet-CoreFx-Trusted-Linux",
          "Parameters": {
            "PB_DockerTag": "fedora23_prereqs"
          },
          "ReportingParameters": {
            "OperatingSystem": "Fedora 2.3",
            "Type": "build/product/",
            "ConfigurationGroup": "Debug"
          }
        },
        {
          "Name": "DotNet-CoreFx-Trusted-Linux",
          "Parameters": {
            "PB_DockerTag": "fedora24_prereqs_v4"
          },
          "ReportingParameters": {
            "OperatingSystem": "Fedora 24",
            "Type": "build/product/",
            "ConfigurationGroup": "Debug"
          }
        },        
        {
          "Name": "DotNet-CoreFx-Trusted-Linux",
          "Parameters": {
            "PB_DockerTag": "opensuse132_prereqs_v4"
          },
          "ReportingParameters": {
            "OperatingSystem": "openSUSE 13.2",
            "Type": "build/product/",
            "ConfigurationGroup": "Debug"
          }
        },
        {
          "Name": "DotNet-CoreFx-Trusted-Linux",
          "Parameters": {
            "PB_DockerTag": "opensuse421_prereqs_v3"
          },
          "ReportingParameters": {
            "OperatingSystem": "openSUSE 42.1",
            "Type": "build/product/",
            "ConfigurationGroup": "Debug"
          }
        },
        {
          "Name": "DotNet-CoreFx-Trusted-Linux",
          "Parameters": {
            "PB_DockerTag": "rhel7_prereqs_2"
          },
          "ReportingParameters": {
            "OperatingSystem": "RedHat 7",
            "Type": "build/product/",
            "ConfigurationGroup": "Debug"
          }
        },
        {
          "Name": "DotNet-CoreFx-Trusted-Linux",
          "Parameters": {
            "PB_DockerTag": "ubuntu1404_prereqs_v3"
          },
          "ReportingParameters": {
            "OperatingSystem": "Ubuntu 14.04",
            "Type": "build/product/",
            "ConfigurationGroup": "Debug"
          }
        },
        {
          "Name": "DotNet-CoreFx-Trusted-Linux",
          "Parameters": {
            "PB_DockerTag": "ubuntu1604_prereqs"
          },
          "ReportingParameters": {
            "OperatingSystem": "Ubuntu 16.04",
            "Type": "build/product/",
            "ConfigurationGroup": "Debug"
          }
        },
        {
          "Name": "DotNet-CoreFx-Trusted-Linux",
          "Parameters": {
            "PB_DockerTag": "ubuntu1610_prereqs_v2"
          },
          "ReportingParameters": {
            "OperatingSystem": "Ubuntu 16.10",
            "Type": "build/product/",
            "ConfigurationGroup": "Debug"
          }
        },
        {
          "Name": "DotNet-CoreFx-Trusted-Linux",
          "Parameters": {
            "PB_DockerTag": "alpine_prereqs"
          },
          "ReportingParameters": {
            "OperatingSystem": "Alpine 3.4.3",
            "Type": "build/product/",
            "ConfigurationGroup": "Debug"
          }
        },        
        {
          "Name": "DotNet-CoreFx-Trusted-OSX",
          "ReportingParameters": {
            "OperatingSystem": "OSX",
            "Type": "build/product/",
            "ConfigurationGroup": "Debug"
          }
        },
        {
          "Name": "DotNet-CoreFx-Trusted-Windows",
          "Parameters": {
            "PB_Platform": "arm"
          },
          "ReportingParameters": {
            "OperatingSystem": "Windows",
            "Type": "build/product/",
            "Platform": "arm",
            "ConfigurationGroup": "Debug"
          }
        },
        {
          "Name": "DotNet-CoreFx-Trusted-Windows",
          "Parameters": {
            "PB_Platform": "arm64"
          },
          "ReportingParameters": {
            "OperatingSystem": "Windows",
            "Type": "build/product/",
            "Platform": "arm64",
            "ConfigurationGroup": "Debug"
          }
        },
        {
          "Name": "DotNet-CoreFx-Trusted-Windows",
          "Parameters": {
            "PB_Platform": "x64"
          },
          "ReportingParameters": {
            "OperatingSystem": "Windows",
            "Type": "build/product/",
            "Platform": "x64",
            "ConfigurationGroup": "Debug"
          }
        },
        {
          "Name": "DotNet-CoreFx-Trusted-Windows",
          "Parameters": {
            "PB_Platform": "x86"
          },
          "ReportingParameters": {
            "OperatingSystem": "Windows",
            "Type": "build/product/",
            "Platform": "x86",
            "ConfigurationGroup": "Debug"
          }
        }
      ]
    },
    {
      "Name": "Publish Packages to Feeds - Release",
      "Parameters": {
        "TreatWarningsAsErrors": "false"
      },
      "BuildParameters": {
        "PB_ConfigurationGroup": "Release"
      },
      "Definitions": [
        {
          "Name": "DotNet-Trusted-Publish",
          "Parameters": {
            "PB_VsoRepositoryName": "DotNet-CoreFX-Trusted",
            "PB_Repo": "corefx"
          },
          "ReportingParameters": {
            "TaskName": "Package Publish",
            "Type": "build/publish/",
            "ConfigurationGroup": "Release - Push to MyGet Feed"
          }
        }
      ],
      "DependsOn": [
        "Trusted-All-Release"
      ]
    },
    {
      "Name": "Publish Packages to Drop - Debug",
      "Parameters": {
        "TreatWarningsAsErrors": "false"
      },
      "BuildParameters": {
        "PB_ConfigurationGroup": "Debug"
      },
      "Definitions": [
        {
          "Name": "DotNet-Trusted-Publish",
          "Parameters": {
            "PB_VsoRepositoryName": "DotNet-CoreFX-Trusted",
            "PB_Repo": "corefx"
          },
          "ReportingParameters": {
            "TaskName": "Package Publish",
            "Type": "build/publish/",
            "ConfigurationGroup": "Debug - Push to Azure Storage"
          }
        }
      ],
      "DependsOn": [
        "Trusted-All-Debug"
      ]
    }    
  ]
}
