<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="12.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <CompatFolder>$(BaseOutputPath)Compat/</CompatFolder>
  </PropertyGroup>

  <Target Name="CopyRefToCompatFolder" Condition="'$(IsReferenceAssembly)'=='true'" AfterTargets="AfterBuild">
    <PropertyGroup>
      <RefCompatFolder>$(CompatFolder)ref</RefCompatFolder>
    </PropertyGroup>
    <ItemGroup>
      <ContractFile Include="$(TargetPath)" />
    </ItemGroup>

    <Copy
        SourceFiles="@(ContractFile)"
        DestinationFolder="$(RefCompatFolder)"
    />
  </Target>

  <Target Name="CopyFacadesToCompatFolder" Condition="'$(IsReferenceAssembly)'!='true'" AfterTargets="AfterBuild">
    <PropertyGroup>
      <FacadesCompatFolder>$(CompatFolder)facades</FacadesCompatFolder>
    </PropertyGroup>
    <ItemGroup>
      <FacadeFile Include="$(TargetPath)" />
    </ItemGroup>

    <Copy
        SourceFiles="@(FacadeFile)"
        DestinationFolder="$(FacadesCompatFolder)"
    />
  </Target>
</Project>
