// Licensed to the .NET Foundation under one or more agreements.
// The .NET Foundation licenses this file to you under the MIT license.
// See the LICENSE file in the project root for more information.

using System;
using System.Globalization;
using Microsoft.Xunit.Performance;
using Xunit;

namespace System.Tests
{
    public class Perf_Double
    {
        public static readonly double dValue = 1.23456789E+5;
        private const int iterCount = 20000;

        [Benchmark(InnerIterationCount = iterCount)]
        [InlineData(104234.343)]
        [InlineData(double.MinValue / 2)]
        [InlineData(Math.PI)]
        [InlineData(Math.E)]
        [InlineData(double.MaxValue)]
        [InlineData(double.MinValue)]
        [InlineData(double.NaN)]
        [InlineData(double.PositiveInfinity)]
        [InlineData(double.NegativeInfinity)]
        [InlineData(2.2250738585072009E-308)]
        [InlineData(-2.2250738585072009E-308)]
        [InlineData(1.1125369292536E-308)]
        [InlineData(0)]
        public void DefaultToString(double number)
        {
            foreach (var iteration in Benchmark.Iterations)
            {
                using (iteration.StartMeasurement())
                {
                    for (int i = 0; i < Benchmark.InnerIterationCount; i++)
                    {
                        number.ToString();
                    }
                }
            }
        }

        [Benchmark(InnerIterationCount = iterCount)]
        [InlineData("zh", 104234.343)]
        [InlineData("zh", double.MinValue / 2)]
        [InlineData("zh", Math.PI)]
        [InlineData("zh", Math.E)]
        [InlineData("zh", double.MaxValue)]
        [InlineData("zh", double.MinValue)]
        [InlineData("zh", double.NaN)]
        [InlineData("zh", double.PositiveInfinity)]
        [InlineData("zh", double.NegativeInfinity)]
        [InlineData("zh", 2.2250738585072009E-308)]
        [InlineData("zh", -2.2250738585072009E-308)]
        [InlineData("zh", 1.1125369292536E-308)]
        [InlineData("zh", 0)]
        public void ToStringWithCultureInfo(string cultureName, double number)
        {
            CultureInfo cultureInfo = new CultureInfo(cultureName);
            foreach (var iteration in Benchmark.Iterations)
            {
                using (iteration.StartMeasurement())
                {
                    for (int i = 0; i < Benchmark.InnerIterationCount; i++)
                    {
                        number.ToString(cultureInfo);
                    }
                }
            }
        }

        [Benchmark(InnerIterationCount = iterCount)]
        [InlineData("R", 104234.343)]
        [InlineData("R", double.MinValue / 2)]
        [InlineData("R", Math.PI)]
        [InlineData("R", Math.E)]
        [InlineData("R", double.MaxValue)]
        [InlineData("R", double.MinValue)]
        [InlineData("R", double.NaN)]
        [InlineData("R", double.PositiveInfinity)]
        [InlineData("R", double.NegativeInfinity)]
        [InlineData("R", 2.2250738585072009E-308)]
        [InlineData("R", -2.2250738585072009E-308)]
        [InlineData("R", 1.1125369292536E-308)]
        [InlineData("R", 0)]
        [InlineData("G", 104234.343)]
        [InlineData("G", double.MinValue / 2)]
        [InlineData("G", Math.PI)]
        [InlineData("G", Math.E)]
        [InlineData("G", double.MaxValue)]
        [InlineData("G", double.MinValue)]
        [InlineData("G", double.NaN)]
        [InlineData("G", double.PositiveInfinity)]
        [InlineData("G", double.NegativeInfinity)]
        [InlineData("G", 2.2250738585072009E-308)]
        [InlineData("G", -2.2250738585072009E-308)]
        [InlineData("G", 1.1125369292536E-308)]
        [InlineData("G", 0)]
        [InlineData("G17", 104234.343)]
        [InlineData("G17", double.MinValue / 2)]
        [InlineData("G17", Math.PI)]
        [InlineData("G17", Math.E)]
        [InlineData("G17", double.MaxValue)]
        [InlineData("G17", double.MinValue)]
        [InlineData("G17", double.NaN)]
        [InlineData("G17", double.PositiveInfinity)]
        [InlineData("G17", double.NegativeInfinity)]
        [InlineData("G17", 2.2250738585072009E-308)]
        [InlineData("G17", -2.2250738585072009E-308)]
        [InlineData("G17", 1.1125369292536E-308)]
        [InlineData("G17", 0)]
        [InlineData("G16", 104234.343)]
        [InlineData("G16", double.MinValue / 2)]
        [InlineData("G16", Math.PI)]
        [InlineData("G16", Math.E)]
        [InlineData("G16", double.MaxValue)]
        [InlineData("G16", double.MinValue)]
        [InlineData("G16", double.NaN)]
        [InlineData("G16", double.PositiveInfinity)]
        [InlineData("G16", double.NegativeInfinity)]
        [InlineData("G16", 2.2250738585072009E-308)]
        [InlineData("G16", -2.2250738585072009E-308)]
        [InlineData("G16", 1.1125369292536E-308)]
        [InlineData("G16", 0)]
        [InlineData("G15", 104234.343)]
        [InlineData("G15", double.MinValue / 2)]
        [InlineData("G15", Math.PI)]
        [InlineData("G15", Math.E)]
        [InlineData("G15", double.MaxValue)]
        [InlineData("G15", double.MinValue)]
        [InlineData("G15", double.NaN)]
        [InlineData("G15", double.PositiveInfinity)]
        [InlineData("G15", double.NegativeInfinity)]
        [InlineData("G15", 2.2250738585072009E-308)]
        [InlineData("G15", -2.2250738585072009E-308)]
        [InlineData("G15", 1.1125369292536E-308)]
        [InlineData("G15", 0)]
        [InlineData("G14", 104234.343)]
        [InlineData("G14", double.MinValue / 2)]
        [InlineData("G14", Math.PI)]
        [InlineData("G14", Math.E)]
        [InlineData("G14", double.MaxValue)]
        [InlineData("G14", double.MinValue)]
        [InlineData("G14", double.NaN)]
        [InlineData("G14", double.PositiveInfinity)]
        [InlineData("G14", double.NegativeInfinity)]
        [InlineData("G14", 2.2250738585072009E-308)]
        [InlineData("G14", -2.2250738585072009E-308)]
        [InlineData("G14", 1.1125369292536E-308)]
        [InlineData("G14", 0)]
        [InlineData("G13", 104234.343)]
        [InlineData("G13", double.MinValue / 2)]
        [InlineData("G13", Math.PI)]
        [InlineData("G13", Math.E)]
        [InlineData("G13", double.MaxValue)]
        [InlineData("G13", double.MinValue)]
        [InlineData("G13", double.NaN)]
        [InlineData("G13", double.PositiveInfinity)]
        [InlineData("G13", double.NegativeInfinity)]
        [InlineData("G13", 2.2250738585072009E-308)]
        [InlineData("G13", -2.2250738585072009E-308)]
        [InlineData("G13", 1.1125369292536E-308)]
        [InlineData("G13", 0)]
        [InlineData("G12", 104234.343)]
        [InlineData("G12", double.MinValue / 2)]
        [InlineData("G12", Math.PI)]
        [InlineData("G12", Math.E)]
        [InlineData("G12", double.MaxValue)]
        [InlineData("G12", double.MinValue)]
        [InlineData("G12", double.NaN)]
        [InlineData("G12", double.PositiveInfinity)]
        [InlineData("G12", double.NegativeInfinity)]
        [InlineData("G12", 2.2250738585072009E-308)]
        [InlineData("G12", -2.2250738585072009E-308)]
        [InlineData("G12", 1.1125369292536E-308)]
        [InlineData("G12", 0)]
        [InlineData("G11", 104234.343)]
        [InlineData("G11", double.MinValue / 2)]
        [InlineData("G11", Math.PI)]
        [InlineData("G11", Math.E)]
        [InlineData("G11", double.MaxValue)]
        [InlineData("G11", double.MinValue)]
        [InlineData("G11", double.NaN)]
        [InlineData("G11", double.PositiveInfinity)]
        [InlineData("G11", double.NegativeInfinity)]
        [InlineData("G11", 2.2250738585072009E-308)]
        [InlineData("G11", -2.2250738585072009E-308)]
        [InlineData("G11", 1.1125369292536E-308)]
        [InlineData("G11", 0)]
        [InlineData("G10", 104234.343)]
        [InlineData("G10", double.MinValue / 2)]
        [InlineData("G10", Math.PI)]
        [InlineData("G10", Math.E)]
        [InlineData("G10", double.MaxValue)]
        [InlineData("G10", double.MinValue)]
        [InlineData("G10", double.NaN)]
        [InlineData("G10", double.PositiveInfinity)]
        [InlineData("G10", double.NegativeInfinity)]
        [InlineData("G10", 2.2250738585072009E-308)]
        [InlineData("G10", -2.2250738585072009E-308)]
        [InlineData("G10", 1.1125369292536E-308)]
        [InlineData("G10", 0)]
        [InlineData("G9", 104234.343)]
        [InlineData("G9", double.MinValue / 2)]
        [InlineData("G9", Math.PI)]
        [InlineData("G9", Math.E)]
        [InlineData("G9", double.MaxValue)]
        [InlineData("G9", double.MinValue)]
        [InlineData("G9", double.NaN)]
        [InlineData("G9", double.PositiveInfinity)]
        [InlineData("G9", double.NegativeInfinity)]
        [InlineData("G9", 2.2250738585072009E-308)]
        [InlineData("G9", -2.2250738585072009E-308)]
        [InlineData("G9", 1.1125369292536E-308)]
        [InlineData("G9", 0)]
        [InlineData("G8", 104234.343)]
        [InlineData("G8", double.MinValue / 2)]
        [InlineData("G8", Math.PI)]
        [InlineData("G8", Math.E)]
        [InlineData("G8", double.MaxValue)]
        [InlineData("G8", double.MinValue)]
        [InlineData("G8", double.NaN)]
        [InlineData("G8", double.PositiveInfinity)]
        [InlineData("G8", double.NegativeInfinity)]
        [InlineData("G8", 2.2250738585072009E-308)]
        [InlineData("G8", -2.2250738585072009E-308)]
        [InlineData("G8", 1.1125369292536E-308)]
        [InlineData("G8", 0)]
        [InlineData("G7", 104234.343)]
        [InlineData("G7", double.MinValue / 2)]
        [InlineData("G7", Math.PI)]
        [InlineData("G7", Math.E)]
        [InlineData("G7", double.MaxValue)]
        [InlineData("G7", double.MinValue)]
        [InlineData("G7", double.NaN)]
        [InlineData("G7", double.PositiveInfinity)]
        [InlineData("G7", double.NegativeInfinity)]
        [InlineData("G7", 2.2250738585072009E-308)]
        [InlineData("G7", -2.2250738585072009E-308)]
        [InlineData("G7", 1.1125369292536E-308)]
        [InlineData("G7", 0)]
        [InlineData("G6", 104234.343)]
        [InlineData("G6", double.MinValue / 2)]
        [InlineData("G6", Math.PI)]
        [InlineData("G6", Math.E)]
        [InlineData("G6", double.MaxValue)]
        [InlineData("G6", double.MinValue)]
        [InlineData("G6", double.NaN)]
        [InlineData("G6", double.PositiveInfinity)]
        [InlineData("G6", double.NegativeInfinity)]
        [InlineData("G6", 2.2250738585072009E-308)]
        [InlineData("G6", -2.2250738585072009E-308)]
        [InlineData("G6", 1.1125369292536E-308)]
        [InlineData("G6", 0)]
        [InlineData("G5", 104234.343)]
        [InlineData("G5", double.MinValue / 2)]
        [InlineData("G5", Math.PI)]
        [InlineData("G5", Math.E)]
        [InlineData("G5", double.MaxValue)]
        [InlineData("G5", double.MinValue)]
        [InlineData("G5", double.NaN)]
        [InlineData("G5", double.PositiveInfinity)]
        [InlineData("G5", double.NegativeInfinity)]
        [InlineData("G5", 2.2250738585072009E-308)]
        [InlineData("G5", -2.2250738585072009E-308)]
        [InlineData("G5", 1.1125369292536E-308)]
        [InlineData("G5", 0)]
        [InlineData("G4", 104234.343)]
        [InlineData("G4", double.MinValue / 2)]
        [InlineData("G4", Math.PI)]
        [InlineData("G4", Math.E)]
        [InlineData("G4", double.MaxValue)]
        [InlineData("G4", double.MinValue)]
        [InlineData("G4", double.NaN)]
        [InlineData("G4", double.PositiveInfinity)]
        [InlineData("G4", double.NegativeInfinity)]
        [InlineData("G4", 2.2250738585072009E-308)]
        [InlineData("G4", -2.2250738585072009E-308)]
        [InlineData("G4", 1.1125369292536E-308)]
        [InlineData("G4", 0)]
        [InlineData("G3", 104234.343)]
        [InlineData("G3", double.MinValue / 2)]
        [InlineData("G3", Math.PI)]
        [InlineData("G3", Math.E)]
        [InlineData("G3", double.MaxValue)]
        [InlineData("G3", double.MinValue)]
        [InlineData("G3", double.NaN)]
        [InlineData("G3", double.PositiveInfinity)]
        [InlineData("G3", double.NegativeInfinity)]
        [InlineData("G3", 2.2250738585072009E-308)]
        [InlineData("G3", -2.2250738585072009E-308)]
        [InlineData("G3", 1.1125369292536E-308)]
        [InlineData("G3", 0)]
        [InlineData("G2", 104234.343)]
        [InlineData("G2", double.MinValue / 2)]
        [InlineData("G2", Math.PI)]
        [InlineData("G2", Math.E)]
        [InlineData("G2", double.MaxValue)]
        [InlineData("G2", double.MinValue)]
        [InlineData("G2", double.NaN)]
        [InlineData("G2", double.PositiveInfinity)]
        [InlineData("G2", double.NegativeInfinity)]
        [InlineData("G2", 2.2250738585072009E-308)]
        [InlineData("G2", -2.2250738585072009E-308)]
        [InlineData("G2", 1.1125369292536E-308)]
        [InlineData("G2", 0)]
        [InlineData("G1", 104234.343)]
        [InlineData("G1", double.MinValue / 2)]
        [InlineData("G1", Math.PI)]
        [InlineData("G1", Math.E)]
        [InlineData("G1", double.MaxValue)]
        [InlineData("G1", double.MinValue)]
        [InlineData("G1", double.NaN)]
        [InlineData("G1", double.PositiveInfinity)]
        [InlineData("G1", double.NegativeInfinity)]
        [InlineData("G1", 2.2250738585072009E-308)]
        [InlineData("G1", -2.2250738585072009E-308)]
        [InlineData("G1", 1.1125369292536E-308)]
        [InlineData("G1", 0)]
        [InlineData("G0", 104234.343)]
        [InlineData("G0", double.MinValue / 2)]
        [InlineData("G0", Math.PI)]
        [InlineData("G0", Math.E)]
        [InlineData("G0", double.MaxValue)]
        [InlineData("G0", double.MinValue)]
        [InlineData("G0", double.NaN)]
        [InlineData("G0", double.PositiveInfinity)]
        [InlineData("G0", double.NegativeInfinity)]
        [InlineData("G0", 2.2250738585072009E-308)]
        [InlineData("G0", -2.2250738585072009E-308)]
        [InlineData("G0", 1.1125369292536E-308)]
        [InlineData("G0", 0)]
        [InlineData("F", 104234.343)]
        [InlineData("F", double.MinValue / 2)]
        [InlineData("F", Math.PI)]
        [InlineData("F", Math.E)]
        [InlineData("F", double.MaxValue)]
        [InlineData("F", double.MinValue)]
        [InlineData("F", double.NaN)]
        [InlineData("F", double.PositiveInfinity)]
        [InlineData("F", double.NegativeInfinity)]
        [InlineData("F", 2.2250738585072009E-308)]
        [InlineData("F", -2.2250738585072009E-308)]
        [InlineData("F", 1.1125369292536E-308)]
        [InlineData("F", 0)]
        [InlineData("F7", 104234.343)]
        [InlineData("F7", double.MinValue / 2)]
        [InlineData("F7", Math.PI)]
        [InlineData("F7", Math.E)]
        [InlineData("F7", double.MaxValue)]
        [InlineData("F7", double.MinValue)]
        [InlineData("F7", double.NaN)]
        [InlineData("F7", double.PositiveInfinity)]
        [InlineData("F7", double.NegativeInfinity)]
        [InlineData("F7", 2.2250738585072009E-308)]
        [InlineData("F7", -2.2250738585072009E-308)]
        [InlineData("F7", 1.1125369292536E-308)]
        [InlineData("F7", 0)]
        [InlineData("F9", 104234.343)]
        [InlineData("F9", double.MinValue / 2)]
        [InlineData("F9", Math.PI)]
        [InlineData("F9", Math.E)]
        [InlineData("F9", double.MaxValue)]
        [InlineData("F9", double.MinValue)]
        [InlineData("F9", double.NaN)]
        [InlineData("F9", double.PositiveInfinity)]
        [InlineData("F9", double.NegativeInfinity)]
        [InlineData("F9", 2.2250738585072009E-308)]
        [InlineData("F9", -2.2250738585072009E-308)]
        [InlineData("F9", 1.1125369292536E-308)]
        [InlineData("F9", 0)]
        [InlineData("F15", 104234.343)]
        [InlineData("F15", double.MinValue / 2)]
        [InlineData("F15", Math.PI)]
        [InlineData("F15", Math.E)]
        [InlineData("F15", double.MaxValue)]
        [InlineData("F15", double.MinValue)]
        [InlineData("F15", double.NaN)]
        [InlineData("F15", double.PositiveInfinity)]
        [InlineData("F15", double.NegativeInfinity)]
        [InlineData("F15", 2.2250738585072009E-308)]
        [InlineData("F15", -2.2250738585072009E-308)]
        [InlineData("F15", 1.1125369292536E-308)]
        [InlineData("F15", 0)]
        [InlineData("F17", 104234.343)]
        [InlineData("F17", double.MinValue / 2)]
        [InlineData("F17", Math.PI)]
        [InlineData("F17", Math.E)]
        [InlineData("F17", double.MaxValue)]
        [InlineData("F17", double.MinValue)]
        [InlineData("F17", double.NaN)]
        [InlineData("F17", double.PositiveInfinity)]
        [InlineData("F17", double.NegativeInfinity)]
        [InlineData("F17", 2.2250738585072009E-308)]
        [InlineData("F17", -2.2250738585072009E-308)]
        [InlineData("F17", 1.1125369292536E-308)]
        [InlineData("F17", 0)]
        [InlineData("F50", 104234.343)]
        [InlineData("F50", double.MinValue / 2)]
        [InlineData("F50", Math.PI)]
        [InlineData("F50", Math.E)]
        [InlineData("F50", double.MaxValue)]
        [InlineData("F50", double.MinValue)]
        [InlineData("F50", double.NaN)]
        [InlineData("F50", double.PositiveInfinity)]
        [InlineData("F50", double.NegativeInfinity)]
        [InlineData("F50", 2.2250738585072009E-308)]
        [InlineData("F50", -2.2250738585072009E-308)]
        [InlineData("F50", 1.1125369292536E-308)]
        [InlineData("F50", 0)]
        [InlineData("E", 104234.343)]
        [InlineData("E", double.MinValue / 2)]
        [InlineData("E", Math.PI)]
        [InlineData("E", Math.E)]
        [InlineData("E", double.MaxValue)]
        [InlineData("E", double.MinValue)]
        [InlineData("E", double.NaN)]
        [InlineData("E", double.PositiveInfinity)]
        [InlineData("E", double.NegativeInfinity)]
        [InlineData("E", 2.2250738585072009E-308)]
        [InlineData("E", -2.2250738585072009E-308)]
        [InlineData("E", 1.1125369292536E-308)]
        [InlineData("E", 0)]
        public void ToStringWithFormat(string format, double number)
        {
            foreach (var iteration in Benchmark.Iterations)
            {
                using (iteration.StartMeasurement())
                {
                    for (int i = 0; i < Benchmark.InnerIterationCount; i++)
                    {
                        number.ToString(format);
                    }
                }
            }
        }

        [Benchmark]
        public static void Decimal_ToString()
        {
            decimal decimalNum = new decimal(dValue);
            foreach (var iteration in Benchmark.Iterations)
                using (iteration.StartMeasurement())
                    decimalNum.ToString();
        }
    }
}
