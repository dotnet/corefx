<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="12.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="$([MSBuild]::GetDirectoryNameOfFileAbove($(MSBuildThisFileDirectory), dir.props))\dir.props" />
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Windows_Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{A28B0064-EFB2-4B77-B97C-DECF5DAB074E}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AssemblyName>System.Security.Cryptography.X509Certificates.Tests</AssemblyName>
    <RootNamespace>System.Security.Cryptography.X509Certificates.Tests</RootNamespace>
    <AllowUnsafeBlocks>true</AllowUnsafeBlocks>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Linux_Debug|AnyCPU' " />
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Linux_Release|AnyCPU' " />
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'OSX_Debug|AnyCPU' " />
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'OSX_Release|AnyCPU' " />
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Windows_Debug|AnyCPU' " />
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Windows_Release|AnyCPU' " />
  <ItemGroup>
    <ProjectReference Include="..\src\System.Security.Cryptography.X509Certificates.csproj">
      <Project>{6f8576c2-6cd0-4df3-8394-00b002d82e40}</Project>
      <Name>System.Security.Cryptography.X509Certificates</Name>
    </ProjectReference>
    <ProjectReference Include="..\..\System.Security.Cryptography.Primitives\src\System.Security.Cryptography.Primitives.csproj">
      <Project>{D04A73AE-E418-4ACD-A132-7688435BE8B5}</Project>
      <Name>System.Security.Cryptography.Primitives</Name>
    </ProjectReference>
    <ProjectReference Include="..\..\System.Security.Cryptography.Encoding\src\System.Security.Cryptography.Encoding.csproj">
      <Project>{AA81E343-5E54-40B0-9381-C459419BE780}</Project>
      <Name>System.Security.Cryptography.Encoding</Name>
    </ProjectReference>
    <ProjectReference Include="..\..\System.Security.Cryptography.Algorithms\src\System.Security.Cryptography.Algorithms.csproj">
      <Project>{81A05E2E-E3AE-4246-B4E6-DD5F31FB71F9}</Project>
      <Name>System.Security.Cryptography.Algorithms</Name>
    </ProjectReference>
  </ItemGroup>
  <ItemGroup>
    <Compile Include="CertTests.cs" />
    <Compile Include="ChainTests.cs" />
    <Compile Include="CollectionImportTests.cs" />
    <Compile Include="CollectionTests.cs" />
    <Compile Include="CtorTests.cs" />
    <Compile Include="ExportTests.cs" />
    <Compile Include="ExtensionsTests.cs" />
    <Compile Include="FindTests.cs" />
    <Compile Include="InteropTests.cs" />
    <Compile Include="LoadFromFileTests.cs" />
    <Compile Include="NameTests.cs" />
    <Compile Include="PfxTests.cs" />
    <Compile Include="PropsTests.cs" />
    <Compile Include="PublicKeyTests.cs" />
    <Compile Include="TestData.cs" />
    <Compile Include="X509StoreTests.cs" />
    <Compile Include="$(CommonTestPath)\Cryptography\ByteUtils.cs">
      <Link>CommonTest\Cryptography\ByteUtils.cs</Link>
    </Compile>
  </ItemGroup>
  <ItemGroup Condition=" '$(TargetsUnix)' == 'true' ">
    <Compile Include="X509FilesystemTests.Unix.cs" />
    <Compile Include="$(CommonPath)\Interop\Unix\Interop.Libraries.cs">
      <Link>Common\Interop\Unix\Interop.Libraries.cs</Link>
    </Compile>
    <Compile Include="$(CommonPath)\Interop\Unix\Interop.Errors.cs">
      <Link>Common\Interop\Unix\Interop.Errors.cs</Link>
    </Compile>
    <Compile Include="$(CommonPath)\Interop\Unix\System.Native\Interop.GetEUid.cs">
      <Link>Common\Interop\Unix\Interop.GetEUid.cs</Link>
    </Compile>
    <Compile Include="$(CommonPath)\Interop\Unix\System.Native\Interop.GetPwUid.cs">
      <Link>Common\Interop\Unix\Interop.GetPwUid.cs</Link>
    </Compile>
    <Compile Include="$(CommonPath)\System\IO\PersistedFiles.Unix.cs">
      <Link>Common\System\IO\PersistedFiles.Unix.cs</Link>
    </Compile>
    <Compile Include="$(CommonPath)\System\IO\PersistedFiles.Names.Unix.cs">
      <Link>Common\System\IO\PersistedFiles.Names.Unix.cs</Link>
    </Compile>
  </ItemGroup>
  <ItemGroup>
    <None Include="project.json" />
  </ItemGroup>
  <Import Project="$([MSBuild]::GetDirectoryNameOfFileAbove($(MSBuildThisFileDirectory), dir.targets))\dir.targets" />
  <!-- Temporary until we have new work in build tools to
       deploy content from nuget packages -->
  <Target Name="CopyX509TestDataToTestDirectory" AfterTargets="CopyTestToTestDirectory" Inputs="$(PackagesDir)$(X509TestPackage)\content" Outputs="$(TestPath)%(TestTargetFramework.Folder)\*.*">
    <PropertyGroup>
      <X509TestPackage>System.Security.Cryptography.X509Certificates.TestData\1.0.0-prerelease</X509TestPackage>
      <TestTargetFrameworkFolder>%(TestTargetFramework.Folder)</TestTargetFrameworkFolder>
    </PropertyGroup>
    <ItemGroup>
      <X509TestDataSrc Include="$(PackagesDir)$(X509TestPackage)\content\**\*.*" />
      <X509TestDataDest Include="@(X509TestDataSrc->'$(TestPath)$(TestTargetFrameworkFolder)\%(RecursiveDir)%(Filename)%(Extension)')" />
    </ItemGroup>
    <Copy SourceFiles="@(X509TestDataSrc)" DestinationFiles="@(X509TestDataDest)" SkipUnchangedFiles="$(SkipCopyUnchangedFiles)" OverwriteReadOnlyFiles="$(OverwriteReadOnlyFiles)" Retries="$(CopyRetryCount)" RetryDelayMilliseconds="$(CopyRetryDelayMilliseconds)" UseHardlinksIfPossible="$(CreateHardLinksForCopyFilesToOutputDirectoryIfPossible)">
      <Output TaskParameter="DestinationFiles" ItemName="FileWrites" />
    </Copy>
  </Target>
</Project>
